create table stud21(
    roll_no int primary key,
    att int,
    status char(1)
);

create table d_stud(
    roll_no int,
    att int
);

INSERT INTO stud21 VALUES (1, 80, NULL);
INSERT INTO stud21 VALUES (2, 70, NULL);
INSERT INTO stud21 VALUES (3, 60, NULL);
INSERT INTO stud21 VALUES (4, 90, NULL);

-- Enable output
SET SERVEROUTPUT ON;

declare 
    cursor cursor_rec is 
    select roll_no,att,status from stud21 
    where att<75 and status is NULL;
begin 
    for rec in cursor_rec loop 
        update stud21 set status = 'D' 
        where roll_no = rec.roll_no;

        insert into d_stud values(rec.roll_no,rec.att);
        
        DBMS_OUTPUT.PUT_LINE('Detained student: ' || rec.roll_no);
    end loop;
    
    -- **THIS IS THE FIX:**
    -- Save all the changes made in the loop
    COMMIT;
    
end;
/

-- Now this will show the results
select * from stud21;
select * from d_stud;





CREATE TABLE employees_1 (
  designation VARCHAR2(100),
  emp_name VARCHAR2(100),
  manager_id INT
);

INSERT INTO employees_1 VALUES ('CLERK', 'John Doe', 130);
INSERT INTO employees_1 VALUES ('CLERK', 'Jane Smith', 110);
INSERT INTO employees_1 VALUES ('MANAGER', 'Mike Johnson', 140);
INSERT INTO employees_1 VALUES ('CLERK', 'Alice Brown', 125);


SET SERVEROUTPUT ON;
DECLARE
  CURSOR c_emp IS
    SELECT emp_name, designation
    FROM employees_1
    WHERE designation = 'CLERK' AND manager_id > 120;
BEGIN
  DBMS_OUTPUT.PUT_LINE('--- Clerks with Manager ID > 120 ---');
  FOR emp_rec IN c_emp LOOP
    DBMS_OUTPUT.PUT_LINE('Name: ' || emp_rec.emp_name || ', Designation: ' || emp_rec.designation);
  END LOOP;
END;
/