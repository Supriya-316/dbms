DROP TABLE IF EXISTS employee_master;
DROP TABLE IF EXISTS branch_master;

CREATE TABLE branch_master (
    branch_id INT PRIMARY KEY,
    branch_name VARCHAR(50) NOT NULL
);

CREATE TABLE employee_master (
    emp_id INT PRIMARY KEY,
    first_name VARCHAR(50),
    middle_name VARCHAR(50),
    last_name VARCHAR(50),
    department VARCHAR(50),
    manager_id INT
);

INSERT INTO branch_master (branch_id, branch_name) VALUES
(1, 'Pune'),
(2, 'Mumbai'),
(3, 'Delhi');

SELECT * FROM branch_master;

INSERT INTO employee_master (emp_id, first_name, middle_name, last_name, department, manager_id) VALUES
(101, 'Amrita', 'R', 'Sharma', 'IT', 201),
(102, 'Rahul', 'K', 'Deshmukh', 'HR', 202),
(103, 'Sneha', 'M', 'Patil', 'Finance', 201),
(104, 'Amit', 'S', 'Kumar', 'IT', 201);

SELECT * FROM employee_master;

CREATE INDEX idx_emp_name ON employee_master (first_name);

SELECT * FROM employee_master WHERE first_name = 'Amrita';

CREATE OR REPLACE VIEW employee_view AS
SELECT emp_id,
       CONCAT(first_name, ' ', middle_name, ' ', last_name) AS emp_name,
       department,
       manager_id
FROM employee_master;

SELECT * FROM employee_view;
